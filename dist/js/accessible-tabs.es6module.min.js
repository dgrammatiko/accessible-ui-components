class t extends HTMLElement{}class e extends HTMLElement{static get observedAttributes(){return["recall","orientation"]}get recall(){return this.getAttribute("recall")}set recall(t){this.setAttribute("recall",t)}attributeChangedCallback(t,e,i){switch(t){case"recall":case"orientation":this.render()}}constructor(){super(),this.hasActive=!1,this.currentActive="",this.hasNested=!1,this.isNested=!1,this.ulElement="",this.tabs=[],this.tabsLinks=[],this.panels=[],this.tabLinkHash=[];new MutationObserver(t=>{t.forEach(t=>this.handleMutations(t))}).observe(this,{childList:!0})}connectedCallback(){this.render()}disconnectedCallback(){if(this.ulElement){Array.from(this.ulElement.querySelectorAll("a")).forEach(t=>{t.removeEventListener("click",this.activateTabFromLink)}),this.ulElement.removeEventListener("keydown",this.keyBehaviour)}}render(){"UL"===this.firstElementChild.nodeName&&this.removeChild(this.firstElementChild),this.buildNavigation()}handleMutations(e){e instanceof MutationRecord&&(Array.from(e.addedNodes).forEach(e=>{e instanceof t&&this.render()}),Array.from(e.removedNodes).forEach(e=>{e instanceof t&&this.render()}))}buildNavigation(){if(this.tabElements=Array.from(this.children),this.tabElements.length){const t=t=>{t.preventDefault(),this.hasActive&&this.hideCurrent();const e=this.currentActive;this.dispatchCustomEvent("joomla.tab.show",t.target,this.querySelector(`#${e.replace("tab-","")}`)),t.target.setAttribute("active",""),t.target.setAttribute("aria-selected","true"),t.target.setAttribute("tabindex","0"),this.querySelector(`#${t.target.id}`).setAttribute("active",""),this.querySelector(`#${t.target.id}`).removeAttribute("aria-hidden"),this.currentActive=t.target.id,this.dispatchCustomEvent("joomla.tab.shown",t.target,this.querySelector(`#${e.replace("tab-","")}`)),this.saveState(`#tab-${t.target.id}`)};"UL"===this.firstElementChild.nodeName&&this.removeChild(this.firstElementChild),this.ulElement=document.createElement("ul"),this.ulElement.setAttribute("role","tablist"),this.tabElements.forEach(e=>{if(e.parentNode!==this)return;const i=e.hasAttribute("active")||!1,r=e.getAttribute("name");if(e.id&&r){const r=document.createElement("li");r.setAttribute("role","presentation");const s=document.createElement("a");s.setAttribute("role","tab"),s.setAttribute("aria-selected",i?"true":"false"),s.setAttribute("aria-controls",e.id),s.setAttribute("tabindex",i?"0":"-1"),s.setAttribute("href",`#${e.id}`),s.setAttribute("id",`tab-${e.id}`),s.textContent=e.getAttribute("name"),i&&(this.hasActive=!0,this.currentActive=e.id);const a=e.getAttribute("link-class");a&&s.setAttribute("class",a),s.addEventListener("click",t),r.appendChild(s),this.ulElement.appendChild(r)}}),this.insertAdjacentElement("afterbegin",this.ulElement)}}hideCurrent(){if(this.currentActive){const t=this.querySelector(`a[aria-controls="${this.currentActive}"]`);this.dispatchCustomEvent("accessible.tabs.hide",t,this.querySelector(`#${this.currentActive}`)),t.removeAttribute("active"),t.setAttribute("tabindex","-1"),this.querySelector(`#${this.currentActive}`).removeAttribute("active"),this.querySelector(`#${this.currentActive}`).setAttribute("aria-hidden","true"),t.removeAttribute("aria-selected"),this.dispatchCustomEvent("accessible.tabs.hidden",t,this.querySelector(`#${this.currentActive}`))}}activateTabFromLink(t){t.preventDefault();const e=this.currentActive;this.hasActive&&this.hideCurrent(),this.dispatchCustomEvent("accessible.tabs.show",t.target,this.querySelector(`#tab-${e}`)),t.target.setAttribute("active",""),t.target.setAttribute("aria-selected","true"),t.target.setAttribute("tabindex","0"),this.querySelector(t.target.hash).setAttribute("active",""),this.querySelector(t.target.hash).removeAttribute("aria-hidden"),this.currentActive=t.target.hash.substring(1),this.dispatchCustomEvent("accessible.tabs.shown",t.target,this.querySelector(`#tab-${e}`)),this.saveState(`#tab-${t.target.hash.substring(1)}`)}showTab(t){document.querySelector(`#tab-${t.id}`).click()}show(t){t.click()}keyBehaviour(t){const e=this.querySelector(`#tab-${this.currentActive}`),i=e.parentNode.previousElementSibling||e.parentNode.parentNode.lastElementChild,r=e.parentNode.nextElementSibling||e.parentNode.parentNode.firstElementChild;if(!t.metaKey&&!t.altKey&&-1!==this.tabs.indexOf(`#${document.activeElement.id}`))switch(t.keyCode){case 37:case 38:t.preventDefault(),t.stopPropagation(),i.querySelector("a").focus(),i.querySelector("a").click();break;case 39:case 40:t.preventDefault(),t.stopPropagation(),r.querySelector("a").focus(),r.querySelector("a").click()}}findAncestorByTagNme(t,e){for(;(t=t.parentElement)&&t.nodeName.toLowerCase()!==e;);return t}dispatchCustomEvent(t,e,i){const r=new CustomEvent(t,{bubbles:!0,cancelable:!0});i&&(r.relatedTarget=i),e.dispatchEvent(r,{once:!0})}}customElements.define("accessible-tab",t),customElements.define("accessible-tabs",e);export{t as AccessibleTab,e as AccessibleTabs};
